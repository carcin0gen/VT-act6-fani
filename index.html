<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Avanzado D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .dashboard {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .chart-container {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .chart-title {
            font-size: 1.2em;
            margin-bottom: 10px;
            color: #333;
            text-align: center;
        }
        svg {
            display: block;
            margin: 0 auto;
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Coordenadas del Mouse -->
        <div class="chart-container">
            <div class="chart-title">Coordenadas del Mouse</div>
            <svg id="coords" width="300" height="300"></svg>
        </div>

        <!-- Brush Linking -->
        <div class="chart-container">
            <div class="chart-title">Brush Linking Interactivo</div>
            <div id="brush-container">
                <svg id="brush1" width="300" height="300"></svg>
                <svg id="brush2" width="300" height="300"></svg>
            </div>
        </div>

        <!-- Drag & Drop -->
        <div class="chart-container">
            <div class="chart-title">Drag & Drop de Elementos</div>
            <svg id="dragdrop" width="300" height="200"></svg>
        </div>

        <!-- Stagger Effect -->
        <div class="chart-container">
            <div class="chart-title">Efecto Stagger Animado</div>
            <svg id="stagger" width="300" height="200"></svg>
        </div>

        <!-- Lissajous -->
        <div class="chart-container" style="grid-column: span 2;">
            <div class="chart-title">Curva de Lissajous</div>
            <svg id="lissajous" width="600" height="300"></svg>
        </div>
    </div>

    <script>
    // 1. Coordenadas del Mouse
    function setupCoords() {
        const svg = d3.select("#coords");
        const text = svg.append('text')
            .attr('font-family', 'Arial')
            .attr('font-size', '12px')
            .attr('fill', 'black');

        svg.on('mousemove', function(event) {
            const [x, y] = d3.pointer(event);
            text.attr('x', x + 10)
               .attr('y', y + 5)
               .text(`(${Math.round(x)}, ${Math.round(y)})`);
        }).on('mouseleave', () => text.text(''));
    }

    // 2. Brush Linking
    function setupBrush() {
        // Datos de ejemplo - reemplaza con tus datos reales
        const data = Array.from({length: 50}, () => ({
            A: Math.random() * 300,
            B: Math.random() * 300
        }));

        const svg1 = d3.select("#brush1"), svg2 = d3.select("#brush2");
        const colorScale = d3.scaleLinear()
            .domain([0, 150, 300])
            .range(["green", "yellow", "red"]);

        function updateCircles(svg, data, color) {
            svg.selectAll("circle").remove();
            svg.selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("r", 5)
                .attr("cx", d => d.A)
                .attr("cy", d => d.B)
                .attr("fill", color)
                .attr("fill-opacity", 0.6);
        }

        updateCircles(svg1, data, "blue");
        updateCircles(svg2, data, "green");

        svg1.on("mousemove", function(event) {
            const [x, y] = d3.pointer(event);
            data.forEach(d => {
                d.dist = Math.sqrt(Math.pow(d.A - x, 2) + Math.pow(d.B - y, 2));
            });
            updateCircles(svg1, data, d => colorScale(d.dist));
            updateCircles(svg2, data, d => colorScale(d.dist));
        });
    }

    // 3. Drag & Drop
    function setupDragDrop() {
        const svg = d3.select("#dragdrop");
        const colors = ["red", "green", "blue"];
        
        svg.selectAll("circle")
            .data(colors)
            .enter()
            .append("circle")
            .attr("cx", (d,i) => 100 + i*100)
            .attr("cy", 100)
            .attr("r", 20)
            .attr("fill", d => d)
            .call(d3.drag()
                .on("start", function() {
                    d3.select(this).attr("fill", "orange");
                })
                .on("drag", function(event) {
                    d3.select(this)
                        .attr("cx", event.x)
                        .attr("cy", event.y);
                })
                .on("end", function(event, d) {
                    d3.select(this).attr("fill", d);
                }));
    }

    // 4. Stagger Effect
    function setupStagger() {
        const svg = d3.select("#stagger");
        let dataset1 = [2, 4, 6, 8, 10, 8, 6, 4, 2];
        let dataset2 = [8, 6, 4, 2, 4, 6, 8, 10, 8];
        
        const update = () => {
            svg.selectAll("rect")
                .data(dataset1)
                .join("rect")
                .attr("x", (d,i) => i * 30)
                .attr("y", d => 200 - d * 10)
                .attr("width", 25)
                .attr("height", d => d * 10)
                .attr("fill", "steelblue")
                .on("click", () => {
                    [dataset1, dataset2] = [dataset2, dataset1];
                    update();
                });
        };
        
        update();
    }

    // 5. Lissajous Curve
    function setupLissajous() {
        const svg = d3.select("#lissajous");
        let lastX = 300, lastY = 150;
        const a = 3, b = 2;
        
        d3.timer(t => {
            const x = 300 + 200 * Math.sin(a * t / 1000);
            const y = 150 + 100 * Math.sin(b * t / 1000 + Math.PI/2);
            
            svg.append("line")
                .attr("x1", lastX)
                .attr("y1", lastY)
                .attr("x2", x)
                .attr("y2", y)
                .attr("stroke", "purple")
                .attr("stroke-width", 2);
                
            lastX = x;
            lastY = y;
        });
    }

    // Inicializar todo cuando el DOM estÃ© listo
    document.addEventListener("DOMContentLoaded", () => {
        setupCoords();
        setupBrush();
        setupDragDrop();
        setupStagger();
        setupLissajous();
    });
    </script>
</body>
</html>
